<h2 class="win-h2">Settings</h2>
<br/>
<br/>
<div class="container">
    <div class="row">
        <h3 class="win-h3">Arma Pfad</h3>
        <br/>
        <div class="input-group">
            <input type="text" id = "armapath" class="form-control" placeholder="C:\Program Files (x86)\Steam\SteamApps\common\Arma 3" aria-describedby="basic-addon2" disabled="true">
            <span class="input-group-btn">
                <button class="btn btn-secondary" id="armapathbtn" type="button">...</button>
              </span>
        </div>
    </div>
    <br/>
    <div class="row">
        <h3 class="win-h3">Arma Startparameter</h3>
        <div class="col-md-12">
            <table>
                <tr>
                    <td>
                        <h5 class="win-h5">Kein Splashscreen:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="check"></span>
                        </label>
                    </td>

                    <td>
                        <h5 class="win-h5">Max. Mem:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <input type="number" class="input-control number" style="color:#444444">
                    </td>

                </tr>
                <tr>
                    <td>
                        <h5 class="win-h5">Intro Überspringen:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="check"></span>
                        </label>
                    </td>

                    <td>
                        <h5 class="win-h5">CPU Count:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <input type="number" class="input-control number" style="color:#444444">
                    </td>
                </tr>
                <tr>
                    <td>
                        <h5 class="win-h5">Nutze Hyper-threading:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="check"></span>
                        </label>
                    </td>

                    <td>
                        <h5 class="win-h5">Max. vRAM:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <input type="number" class="input-control number" style="color:#444444">
                    </td>
                </tr>
                <tr>
                    <td>
                        <h5 class="win-h5">Fenstermodus:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="check"></span>
                        </label>
                    </td>

                    <td>
                        <h5 class="win-h5">Ex. Threads:&nbsp;&nbsp;</h5>
                    </td>
                    <td>
                        <input type="number" class="input-control number" style="color:#444444">
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>

<script>

    $( document ).ready(function() {
      path = "";
        storage.get('settings', function(error, data) {
            path = data.armapath;
        });
        if(path == null) {
          debugger;
          var Registry = require('winreg')
          , regKey = new Registry({                                       // new operator is optional
            hive: Winreg.HKLM,                                          // HKEY_LOCAL_MACHINE
            key:  '\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Steam App 107410' // Arma 3 Key
          })

          // list autostart programs
          regKey.values(function (err, items /* array of RegistryItem */) {
            if(items[3].value != null) {
              path = items[3].value;
            };
          });
        } else {

          $('#armapath').val(path);
        };
    });

    var toggleWifi = function() {
        var obj = document.getElementById("wifiToggle").winControl;
        console.log("Wifi toggled. Current status: " + (obj.checked ? "on" : "off"));
    }

    document.getElementById("armapathbtn").addEventListener("click", function() {
      var options = {
      filters: [
            {name: 'Arma3.exe', extensions: ['exe']},
          ],
      title: "Bitte wähle deine Arma3.exe aus",
      properties: ['openFile'],
      defaultPath: "C:\\Program Files (x86)\\Steam\\SteamApps\\common\\Arma 3\\Arma3.exe"
    };
        var path = dialog.showOpenDialog(options);
        $('#armapath').val(path);
        storage.set('settings', { armapath: path}, function(error) {
        });
    });

    // To protect against untrusted code execution, all functions are required to be marked as supported for processing before they can be used inside a data-win-options attribute in HTML markup.
    WinJS.Utilities.markSupportedForProcessing(toggleWifi);

    WinJS.UI.processAll();
</script>
